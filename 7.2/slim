FROM node:7-slim

MAINTAINER cjy37 <rocky.cn@foxmail.com>

RUN mkdir -p  /wwwroot/htdocs/www
VOLUME /wwwroot/htdocs/www
ADD . /wwwroot/htdocs/www
WORKDIR /wwwroot/htdocs/www

RUN npm config set registry https://registry.npm.taobao.org --global
RUN npm install -g node-gyp bower grunt-cli
RUN npm install

COPY docker-entrypoint.sh /usr/local/bin/
ENTRYPOINT ["docker-entrypoint.sh"]

EXPOSE 80

CMD grunt --gruntfile Gruntfile.js prod && node --harmony app.js
